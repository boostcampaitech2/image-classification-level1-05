
Namespace(batch_size=64, criterion='cross_entropy', data_dir='/opt/ml/input/data/train/images', dataset='MaskBaseDataset', epochs=5, log_interval=20, lr=0.001, lr_decay_step=20, model='BaseModel', model_dir='./model', name='exp', optimizer='Adam', resize=(128, 96), seed=42, transform='BaseTransform', val_batch_size=1000, val_ratio=0.2)
/opt/conda/lib/python3.8/site-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
Epoch: 1/5 [020/236]
training accuracy: 53.12%	training loss: 2.0109	learning rate: 0.001
Epoch: 1/5 [040/236]
training accuracy: 71.25%	training loss: 0.9025	learning rate: 0.001
Epoch: 1/5 [060/236]
training accuracy: 80.00%	training loss: 0.6238	learning rate: 0.001
Epoch: 1/5 [080/236]
training accuracy: 82.03%	training loss: 0.5068	learning rate: 0.001
Epoch: 1/5 [100/236]
training accuracy: 80.78%	training loss: 0.5783	learning rate: 0.001
Epoch: 1/5 [120/236]
training accuracy: 82.03%	training loss: 0.5074	learning rate: 0.001
Epoch: 1/5 [140/236]
training accuracy: 82.42%	training loss: 0.4919	learning rate: 0.001
Epoch: 1/5 [160/236]
training accuracy: 84.45%	training loss: 0.4665	learning rate: 0.001
Epoch: 1/5 [180/236]
training accuracy: 85.86%	training loss: 0.4361	learning rate: 0.001
Epoch: 1/5 [200/236]
training accuracy: 87.34%	training loss: 0.3677	learning rate: 0.001
Epoch: 1/5 [220/236]
training accuracy: 86.95%	training loss: 0.3614	learning rate: 0.001
  0%|[32m                                                                                                                                [39m| 0/3 [00:00<?, ?it/s][W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
100%|[32mâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ[39m| 3/3 [00:07<00:00,  2.42s/it]
New best model for val accuracy : 0.69%! saving the best model..
Validation:
accuracy: 68.81%	loss: 0.40
best acc : 68.81%	best loss: 0.40
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
Epoch: 2/5 [020/236]
training accuracy: 89.22%	training loss: 0.3078	learning rate: 0.001
Epoch: 2/5 [040/236]
training accuracy: 90.62%	training loss: 0.2836	learning rate: 0.001
Epoch: 2/5 [060/236]
training accuracy: 91.33%	training loss: 0.2570	learning rate: 0.001
Epoch: 2/5 [080/236]
training accuracy: 89.30%	training loss: 0.3087	learning rate: 0.001
Epoch: 2/5 [100/236]
training accuracy: 90.31%	training loss: 0.2989	learning rate: 0.001
Epoch: 2/5 [120/236]
training accuracy: 88.20%	training loss: 0.3340	learning rate: 0.001
Epoch: 2/5 [140/236]
training accuracy: 87.89%	training loss: 0.3467	learning rate: 0.001
Epoch: 2/5 [160/236]
training accuracy: 89.69%	training loss: 0.2975	learning rate: 0.001
Epoch: 2/5 [180/236]
training accuracy: 90.39%	training loss: 0.2679	learning rate: 0.001
Epoch: 2/5 [200/236]
training accuracy: 91.17%	training loss: 0.2551	learning rate: 0.001
Epoch: 2/5 [220/236]
training accuracy: 92.34%	training loss: 0.2468	learning rate: 0.001
  0%|[32m                                                                                                                                [39m| 0/3 [00:00<?, ?it/s][W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
100%|[32mâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ[39m| 3/3 [00:07<00:00,  2.36s/it]
Validation:
accuracy: 55.42%	loss: 0.88
best acc : 68.81%	best loss: 0.40
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
Epoch: 3/5 [020/236]
training accuracy: 92.58%	training loss: 0.2062	learning rate: 0.001
Epoch: 3/5 [040/236]
training accuracy: 93.28%	training loss: 0.1584	learning rate: 0.001
Epoch: 3/5 [060/236]
training accuracy: 92.34%	training loss: 0.2152	learning rate: 0.001
Epoch: 3/5 [080/236]
training accuracy: 92.50%	training loss: 0.2095	learning rate: 0.001
Epoch: 3/5 [100/236]
training accuracy: 92.27%	training loss: 0.2078	learning rate: 0.001
Epoch: 3/5 [120/236]
training accuracy: 91.41%	training loss: 0.2125	learning rate: 0.001
Epoch: 3/5 [140/236]
training accuracy: 91.48%	training loss: 0.2163	learning rate: 0.001
Epoch: 3/5 [160/236]
training accuracy: 90.70%	training loss: 0.2539	learning rate: 0.001
Epoch: 3/5 [180/236]
training accuracy: 92.27%	training loss: 0.2134	learning rate: 0.001
Epoch: 3/5 [200/236]
training accuracy: 91.02%	training loss: 0.2420	learning rate: 0.001
Epoch: 3/5 [220/236]
training accuracy: 90.47%	training loss: 0.2786	learning rate: 0.001
  0%|[32m                                                                                                                                [39m| 0/3 [00:00<?, ?it/s][W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
100%|[32mâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ[39m| 3/3 [00:07<00:00,  2.38s/it]
New best model for val accuracy : 0.72%! saving the best model..
Validation:
accuracy: 71.93%	loss: 0.28
best acc : 71.93%	best loss: 0.28
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
Epoch: 4/5 [020/236]
training accuracy: 94.14%	training loss: 0.1745	learning rate: 0.001
Epoch: 4/5 [040/236]
training accuracy: 94.84%	training loss: 0.1485	learning rate: 0.001
Epoch: 4/5 [060/236]
training accuracy: 94.84%	training loss: 0.1629	learning rate: 0.001
Epoch: 4/5 [080/236]
training accuracy: 94.92%	training loss: 0.1576	learning rate: 0.001
Epoch: 4/5 [100/236]
training accuracy: 93.75%	training loss: 0.1764	learning rate: 0.001
Epoch: 4/5 [120/236]
training accuracy: 94.30%	training loss: 0.1710	learning rate: 0.001
Epoch: 4/5 [140/236]
training accuracy: 91.80%	training loss: 0.2547	learning rate: 0.001
Epoch: 4/5 [160/236]
training accuracy: 93.20%	training loss: 0.1940	learning rate: 0.001
Epoch: 4/5 [180/236]
training accuracy: 94.69%	training loss: 0.1639	learning rate: 0.001
Epoch: 4/5 [200/236]
training accuracy: 93.52%	training loss: 0.1844	learning rate: 0.001
Epoch: 4/5 [220/236]
training accuracy: 93.91%	training loss: 0.1627	learning rate: 0.001
  0%|[32m                                                                                                                                [39m| 0/3 [00:00<?, ?it/s][W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
100%|[32mâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ[39m| 3/3 [00:07<00:00,  2.34s/it]
Validation:
accuracy: 67.99%	loss: 0.45
best acc : 71.93%	best loss: 0.28
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
Epoch: 5/5 [020/236]
training accuracy: 95.94%	training loss: 0.1197	learning rate: 0.001
Epoch: 5/5 [040/236]
training accuracy: 96.41%	training loss: 0.1215	learning rate: 0.001
Epoch: 5/5 [060/236]
training accuracy: 94.30%	training loss: 0.2013	learning rate: 0.001
Epoch: 5/5 [080/236]
training accuracy: 95.39%	training loss: 0.1651	learning rate: 0.001
Epoch: 5/5 [100/236]
training accuracy: 96.41%	training loss: 0.1335	learning rate: 0.001
Epoch: 5/5 [120/236]
training accuracy: 96.02%	training loss: 0.1268	learning rate: 0.001
Epoch: 5/5 [140/236]
training accuracy: 93.83%	training loss: 0.1643	learning rate: 0.001
Epoch: 5/5 [160/236]
training accuracy: 93.36%	training loss: 0.1876	learning rate: 0.001
Epoch: 5/5 [180/236]
training accuracy: 93.20%	training loss: 0.2047	learning rate: 0.001
Epoch: 5/5 [200/236]
training accuracy: 94.06%	training loss: 0.1773	learning rate: 0.001
Epoch: 5/5 [220/236]
training accuracy: 94.22%	training loss: 0.1875	learning rate: 0.001
  0%|[32m                                                                                                                                [39m| 0/3 [00:00<?, ?it/s][W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
100%|[32mâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ[39m| 3/3 [00:07<00:00,  2.35s/it]
New best model for val accuracy : 0.73%! saving the best model..
Validation:
accuracy: 72.91%	loss: 0.24
best acc : 72.91%	best loss: 0.24